<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>L8Smartlight</title>
    
    <meta name="description" content="A nodejs library in order to facillitate communication with an L8 Smartlight" />
    
    
    
    <meta property="og:title" content=""/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content=""/>
    
    <meta property="og:url" content=""/>
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">
    
    
    <script>
    var config = {"monospaceLinks":true,"cleverLinks":true,"default":{"outputSourceFiles":true},"applicationName":"node-l8smartlight","disqus":"","googleAnalytics":"","openGraph":{"title":"","type":"website","image":"","site_name":"","url":""},"meta":{"title":"L8Smartlight","description":"A nodejs library in order to facillitate communication with an L8 Smartlight","keyword":""}};
    </script>
    

    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName"><a href="index.html">node-l8smartlight</a></h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">
    
        <li class="item" data-name="L8">
            <span class="title">
                <a href="L8.html">L8</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="L8#isConnected"><a href="L8.html#isConnected">isConnected</a></li>
            
                <li data-name="L8#receiveBuffer_"><a href="L8.html#receiveBuffer_">receiveBuffer_</a></li>
            
                <li data-name="L8#serialport_"><a href="L8.html#serialport_">serialport_</a></li>
            
                <li data-name="L8.MAGIC_BYTES"><a href="L8.html#MAGIC_BYTES">MAGIC_BYTES</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="L8#buildFrame"><a href="L8.html#buildFrame">buildFrame</a></li>
            
                <li data-name="L8#clearLED"><a href="L8.html#clearLED">clearLED</a></li>
            
                <li data-name="L8#clearMatrix"><a href="L8.html#clearMatrix">clearMatrix</a></li>
            
                <li data-name="L8#clearScrollingText"><a href="L8.html#clearScrollingText">clearScrollingText</a></li>
            
                <li data-name="L8#clearSuperLED"><a href="L8.html#clearSuperLED">clearSuperLED</a></li>
            
                <li data-name="L8#close"><a href="L8.html#close">close</a></li>
            
                <li data-name="L8#encodeBGRMatrixColor"><a href="L8.html#encodeBGRMatrixColor">encodeBGRMatrixColor</a></li>
            
                <li data-name="L8#encodeBGRSingleColor"><a href="L8.html#encodeBGRSingleColor">encodeBGRSingleColor</a></li>
            
                <li data-name="L8#encodeRGBSingleColor"><a href="L8.html#encodeRGBSingleColor">encodeRGBSingleColor</a></li>
            
                <li data-name="L8#onResponse_"><a href="L8.html#onResponse_">onResponse_</a></li>
            
                <li data-name="L8#open"><a href="L8.html#open">open</a></li>
            
                <li data-name="L8#parseFrames_"><a href="L8.html#parseFrames_">parseFrames_</a></li>
            
                <li data-name="L8#ping"><a href="L8.html#ping">ping</a></li>
            
                <li data-name="L8#sendFrame"><a href="L8.html#sendFrame">sendFrame</a></li>
            
                <li data-name="L8#setLED"><a href="L8.html#setLED">setLED</a></li>
            
                <li data-name="L8#setMatrix"><a href="L8.html#setMatrix">setMatrix</a></li>
            
                <li data-name="L8#setOrientation"><a href="L8.html#setOrientation">setOrientation</a></li>
            
                <li data-name="L8#setScrollingText"><a href="L8.html#setScrollingText">setScrollingText</a></li>
            
                <li data-name="L8#setSuperLED"><a href="L8.html#setSuperLED">setSuperLED</a></li>
            
                <li data-name="L8#stopApplication"><a href="L8.html#stopApplication">stopApplication</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            <span class="subtitle">Events</span>
            
                <li data-name="L8#event:frameReceived"><a href="L8.html#event:frameReceived">frameReceived</a></li>
            
                <li data-name="L8#event:frameSent"><a href="L8.html#event:frameSent">frameSent</a></li>
            
            </ul>
        </li>
    
        <li class="item" data-name="MatrixBuilder">
            <span class="title">
                <a href="MatrixBuilder.html">MatrixBuilder</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="MatrixBuilder#initialMatrix_"><a href="MatrixBuilder.html#initialMatrix_">initialMatrix_</a></li>
            
                <li data-name="MatrixBuilder#operations_"><a href="MatrixBuilder.html#operations_">operations_</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="MatrixBuilder.map"><a href="MatrixBuilder.html#map">map</a></li>
            
                <li data-name="MatrixBuilder#column"><a href="MatrixBuilder.html#column">column</a></li>
            
                <li data-name="MatrixBuilder#createArrayWithSize"><a href="MatrixBuilder.html#createArrayWithSize">createArrayWithSize</a></li>
            
                <li data-name="MatrixBuilder#operation"><a href="MatrixBuilder.html#operation">operation</a></li>
            
                <li data-name="MatrixBuilder#rectangle"><a href="MatrixBuilder.html#rectangle">rectangle</a></li>
            
                <li data-name="MatrixBuilder#row"><a href="MatrixBuilder.html#row">row</a></li>
            
                <li data-name="MatrixBuilder#toMatrix"><a href="MatrixBuilder.html#toMatrix">toMatrix</a></li>
            
                <li data-name="MatrixBuilder#validateColors_"><a href="MatrixBuilder.html#validateColors_">validateColors_</a></li>
            
                <li data-name="MatrixBuilder#validateCoordinates_"><a href="MatrixBuilder.html#validateCoordinates_">validateCoordinates_</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
    </ul>
</div>
    <div class="main">
        <h1 class="page-title" data-filename="Promisify.js.html">Source: Promisify.js</h1>
        


    
    <section>
        <article>
            <pre class="prettyprint source"><code>/**
 * @module Promisify
 */

var Promise = require("rsvp").Promise;

/**
 * Wrap the given function into a promise based version.
 *
 * The promise based version is identical to the one given, it allows non promise
 * calls by supplying all the arguments as usual. But if the callback function
 * is omitted it returns a promise instead.
 *
 * This function assumes that the given function has already been checked to be
 * a valid candidate for promise wrapping (last argument is a callback).
 *
 * @param originalFunction
 */
var wrapInPromise = function(originalFunction) {
    var arity = originalFunction.length;
    return function(/* variable arguments */) {
        var self = this;

        if (arguments.length !== arity - 1) {
            // If any other constelation then not providing the last argument callback
            // is found we simply call through
            return originalFunction.apply(self, arguments);
        }

        var args = Array.prototype.slice.call(arguments);


        // The callback has not been given lets promisify it
        return new Promise(function(resolve, reject) {
            args.push(function(error, value) {
                if (error) {
                    reject(error);
                } else {
                    resolve(value);
                }
            });

            originalFunction.apply(self, args);
        });
    }
};

/**
 * Wrapper to take an arbitrary object and turn all it's callback taking functions
 * into a version which allows to omit the callback and instead receive a promise.
 *
 * This only works if the callback is the last argument in the list. Furthermore
 * it needs to be called `fn`.
 *
 * Currently inheritance through the prototype chain is ignored completely
 *
 * Warning: This operation changes the underlying function replacing it with a
 * wrapped version.
 *
 * @param {Object} target
 */
var Promisify = function(target) {
    var property;
    for(property in target) {
        if (!target.hasOwnProperty(property)) {
            continue;
        }

        if (typeof target[property] !== "function") {
            continue;
        }

        var functionAnalyseRegExp = /\s*function[^(]*\(([^)]*,\s*fn|fn)\)/i;

        if (target[property].toString().match(functionAnalyseRegExp) === null) {
            // No fn argument present
            continue;
        }

        target[property] = wrapInPromise(target[property]);
    }
};

exports.Promisify = Promisify;</code></pre>
        </article>
    </section>





        

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.2</a> on Mon Jun 30 2014 22:57:16 GMT+0200 (MESZ)
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script src="scripts/main.js"></script>
</body>
</html>
